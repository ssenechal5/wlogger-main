Ext.define("com.actility.specific.baidumaps",{statics:{_translatePosition:function(b,d){if(GPS.isInChina(b,d)&&com.actility.global.gmapsEcjEncryptMode){var a=GPS.gcj_encrypt(b,d);var c=GPS.bd_encrypt(a.lat,a.lon);return c}else{return{lat:b,lon:d}}},_getPosition:function(b,a){translatedPos=this._translatePosition(a,b);return new BMap.Point(translatedPos.lon,translatedPos.lat)},_extendMap:function(a,c){if(typeof a.arrayOfPoints=="undefined"){a.arrayOfPoints=[]}a.arrayOfPoints.push(c);var b=a.getViewport(a.arrayOfPoints);a.centerAndZoom(b.center,b.zoom)},externalApiLoaded:function(){var a=["resources/js/ux/BMapPanel.min.js","resources/js/bmaps.markercluster/MarkerClusterer.min.js","resources/js/bmaps.texticonoverlay/TextIconOverlay.min.js","resources/js/gps.min.js"];var b=new ScriptLoader(a,com.actility.specific.baidumaps.callbackAfterApiLoaded,com.actility.specific.baidumaps.callbackAfterApiLoadedParameters);b.loadFiles()},loadMapDependencies:function(c,a){var b=[com.actility.global.bmapsUrl];com.actility.specific.baidumaps.callbackAfterApiLoaded=c;com.actility.specific.baidumaps.callbackAfterApiLoadedParameters=a;var d=new ScriptLoader(b,function(){},null);d.loadFiles()},isLoaded:function(){return(typeof BMap=="object")},displayBullet:function(h,k,a,j,d,i,e,c,m){if(m==true){if(typeof h.clusterMarker=="undefined"){h.clusterMarker=new BMapLib.MarkerClusterer(h)}}var b=new BMap.Icon(com.actility.global.buildUrl("/gui/resources/images/marker_"+e+".png"),new BMap.Size(32,37),{anchor:new BMap.Size(16,37),infoWindowAnchor:new BMap.Size(16,0)});var l=this._getPosition(a,k);var g=new BMap.Marker(l,{icon:b});var f=new BMap.InfoWindow(j);g.addEventListener("mouseover",function(n){this.openInfoWindow(f)});if(m==true){h.clusterMarker.addMarker(g)}else{h.addOverlay(g)}com.actility.specific.baidumaps._extendMap(h,l)},displayPolyline:function(c,f,b){var a=[];for(var d=0;d<f.length;d++){a.push(this._getPosition(f[d].lon,f[d].lat))}var e=new BMap.Polyline(a,{strokeStyle:"solid",strokeColor:b,strokeOpacity:1,strokeWeight:2});c.addOverlay(e)},displayLRR:function(e,h,a,g,f,b){var j=new BMap.Icon(com.actility.global.buildUrl("/gui/resources/images/lrr_"+b+".png"),new BMap.Size(62,90),{anchor:new BMap.Size(31,45),infoWindowAnchor:new BMap.Size(31,0)});var i=this._getPosition(a,h);var d=new BMap.Marker(i,{icon:j});e.addOverlay(d);var c=new BMap.InfoWindow(g);d.addEventListener("mouseover",function(k){this.openInfoWindow(c)});com.actility.specific.baidumaps._extendMap(e,i)},buildMapPanel:function(a){var d=null;var c=Ext.create("Ext.window.Window",{title:a.title,layout:"fit",width:450,height:450,x:10,y:10,border:true,maximizable:true,items:{xtype:"bmappanel",width:"100%",height:"100%",bmapType:"map",border:true,zoomLevel:15,lng:0,lat:0,mapConfigs:["enableScrollWheelZoom","enableAutoResize"],mapControls:[{controlName:"ScaleControl",anchor:"BMAP_ANCHOR_TOP_LEFT"},{controlName:"MapTypeControl",mapTypes:[BMAP_NORMAL_MAP,BMAP_HYBRID_MAP]},{controlName:"NavigationControl",anchor:"BMAP_ANCHOR_TOP_RIGHT",type:"BMAP_NAVIGATION_CONTROL_SMALL"}],listeners:{mapready:b,resize:e}}});function b(f,g){d=g;a.onMapReady.call(this,g,a)}function e(h,g,f){}c.show()}}});