Ext.define("Ext.ux.BaiduMapView",{extend:"Ext.panel.Panel",alias:"widget.bmappanel",requires:["Ext.window.MessageBox"],initComponent:function(){this.callParent()},afterRender:function(){this.loaded=false;this.callParent();this.addEvents("mapready");if(this.bmapType==="map"){this.bmap=new BMap.Map(this.getId());this.bmap.centerAndZoom(new BMap.Point(this.lng,this.lat),this.zoomLevel);this.bmap.addEventListener("tilesloaded",function(){this.onLoaded(this)}.bind(this))}},onLoaded:function(a){if(!a.loaded){a.addMapConfigs();a.addMapControls();a.addMapMarkers(a.markers);a.fireEvent("mapready",a,a.bmap);a.loaded=true}},getMap:function(){return this.bmap},addMapMarkers:function(b){if(Ext.isArray(b)){for(var a=0;a<b.length;a++){this.addMapMarker(b[a])}}},addMapMarker:function(c){var a=new BMap.Point(c.x,c.y);var b=new BMap.Marker(a);if(c.isDragging==true){b.enableDragging()}else{b.disableDragging()}this.getMap().addOverlay(b)},addMapControls:function(){if(Ext.isArray(this.mapControls)){for(var a=0;a<this.mapControls.length;a++){this.addMapControl(this.mapControls[a])}}},addMapControl:function(a){var c=a.controlName;delete a.controlName;var b=new BMap[c](a);this.getMap().addControl(b)},addMapConfigs:function(){if(Ext.isArray(this.mapConfigs)){for(var a=0;a<this.mapConfigs.length;a++){this.addMapConfig(this.mapConfigs[a])}}else{if(typeof this.mapConfigs==="string"){this.addMapConfig(this.mapConfigs)}}},addMapConfig:function(a){this.getMap()[a]()}});