Ext.define("com.actility.specific.extjs",{statics:{specificClearQueryParameters:function(){var b=false;if(navigator.appName.indexOf("Internet Explorer")!=-1){b=true}if(b===false){var c=window.location.toString();if(c.indexOf("?")>0&&c.indexOf("state=")<0){var a=c.substring(0,c.indexOf("?"));window.history.replaceState({},document.title,a)}}},specificGetVendorId:function(){var a=this.vendorId;return a},specificGetAdminAccessTokenQueryParameters:function(){var a=Ext.Object.fromQueryString(location.search.substring(1)).adminAccessToken;return a},specificNotification:function(e,c,f){var a=new Ext.XTemplate('<img src="{imgSrc}" class="simpleIcon {iconCls}"/> {message}');var b=a.apply({imgSrc:Ext.BLANK_IMAGE_URL,iconCls:c?c:"",message:e});var d=Ext.create("widget.uxNotification",{closable:false,corner:"bl",stickOnClick:false,autoCloseDelay:8000,manager:"footer",slideInDuration:400,slideBackDuration:1500,cls:"ux-notification-light",html:b,listeners:{close:function(g){console.log("Close Notif !"+g);if(g){if(!Ext.isEmpty(WirelessLogger)&&!Ext.isEmpty(WirelessLogger.util)&&!Ext.isEmpty(WirelessLogger.util.Keycloak)&&WirelessLogger.util.Keycloak.isReady()){WirelessLogger.util.Keycloak.logout()}}}}});d.show()},specificInfo:function(a,b){this.specificWarningStatusBar(a,b)},specificWarning:function(a,b){this.specificWarningStatusBar(a,b)},specificError:function(a,b){this.specificWarningStatusBar(a,b)},specificWarningStatusBar:function(a,c){var b=this;if(typeof a=="undefined"){return}b.specificWarningMessage=c;b.specificWarningMessageWhere=a;if(typeof(com.actility.specific.extjs.specificWarningSlide)=="undefined"){com.actility.specific.extjs.specificWarningSlide=Ext.Function.createBuffered(function(){if((typeof com.actility.specific.extjs.specificWarningMessageWhere.down("image[itemId=statusImage]")!=="undefined")&&(b.specificWarningMessageWhere.down("image[itemId=statusImage]")!==null)){b.specificWarningMessageWhere.down("image[itemId=statusImage]").setSrc("resources/images/icon-warning.png")}if((typeof com.actility.specific.extjs.specificWarningMessageWhere.down("label[itemId=statusMessage]")!=="undefined")&&(b.specificWarningMessageWhere.down("label[itemId=statusMessage]")!==null)){b.specificWarningMessageWhere.down("label[itemId=statusMessage]").setText("  "+com.actility.specific.extjs.specificWarningMessage,false);b.specificWarningMessageWhere.down("label[itemId=statusMessage]").setWidth(500)}if((typeof com.actility.specific.extjs.specificWarningMessageWhere.down("container[itemId=status]")!=="undefined")&&(b.specificWarningMessageWhere.down("container[itemId=status]")!==null)){b.specificWarningMessageWhere.down("container[itemId=status]").setWidth(600);b.specificWarningMessageWhere.down("container[itemId=status]").el.slideIn()}b.specificWarningSlideOut()},500)}if(typeof(com.actility.specific.extjs.specificWarningSlideOut)=="undefined"){com.actility.specific.extjs.specificWarningSlideOut=Ext.Function.createBuffered(function(){if((typeof com.actility.specific.extjs.specificWarningMessageWhere.down("image[itemId=statusImage]")!=="undefined")&&(com.actility.specific.extjs.specificWarningMessageWhere.down("image[itemId=statusImage]")!==null)){com.actility.specific.extjs.specificWarningMessageWhere.down("image[itemId=statusImage]").setSrc("resources/images/icon-none.png")}if((typeof com.actility.specific.extjs.specificWarningMessageWhere.down("label[itemId=statusMessage]")!=="undefined")&&(com.actility.specific.extjs.specificWarningMessageWhere.down("label[itemId=statusMessage]")!==null)){com.actility.specific.extjs.specificWarningMessageWhere.down("label[itemId=statusMessage]").setText("")}},3000)}com.actility.specific.extjs.specificWarningSlide()},toolManageExpand:function(f){Ext.getCmp("rootViewport").suspendLayout=true;var e=Ext.getCmp("rootViewport").down("gridpanel[itemId=dashboardResultGridPannel]");var g=e.getPlugin();var c=g.recordsExpanded;var b=e.getStore();for(var d=0;d<b.getCount();d++){var a=b.getAt(d).internalId;if(f===false){if(typeof(c[a])=="undefined"||c[a]===true){g.toggleRow(d,b.getAt(d))}}else{if(typeof(c[a])=="undefined"||c[a]===false){g.toggleRow(d,b.getAt(d))}}}},toolStopDashboardRefresh:function(){clearInterval(com.actility.global.dashboardTimer);com.actility.global.dashboardTimer=null;this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR Auto Reload deactivated"))},toolStartDashboardRefresh:function(a){if(com.actility.global.dashboardTimer!==null){clearInterval(com.actility.global.dashboardTimer)}console.log("Timer:"+a);if(a==""||a=="no"||a=="n"||a=="null"||a==null){this.toolStopDashboardRefresh();return}com.actility.global.dashboardTimer=setInterval("com.actility.specific.extjs.toolRefreshDashboard(1)",a);this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("Auto Reload activated"))},refreshCustomerList:function(){var b="";for(var a=0;a<com.actility.global.customerIdList.length;a++){if(a>0){b+=", "}b+=com.actility.global.customerIdList[a].customerId}if(b=="*"){com.actility.global.notNetworkPartnerAccess=false}},toolRefreshCustomerList:function(){var b="";for(var a=0;a<com.actility.global.customerIdList.length;a++){if(a>0){b+=", "}b+=com.actility.global.customerIdList[a].customerId}if(b=="*"){com.actility.global.notNetworkPartnerAccess=false}Ext.getCmp("dashboardHeader").setTitle(com.actility.locale.translate("LBL Dashboard")+" [ "+b+" ]")},toolUTCtoLocal:function(g){var a=g.indexOf(" ");if(a!=-1){g=g.substr(0,a)+"T"+g.substr(a+1)+"Z"}var h=new Date(g);var d=h.getTimezoneOffset();var e=h.getTime()-d*60*1000;var c=new Date(e);var i=c.toISOString();var b=i.indexOf("Z");if(b!=-1){i=i.substr(0,b)}var f=i.indexOf("T");if(f!=-1){i=i.substr(0,f)+" "+i.substr(f+1)}return i},callbackStoreDataChanged:function(b,a,c){com.actility.specific.extjs.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR Data loaded")+"("+b.getCount()+")");if(Ext.getCmp("header")!=undefined){Ext.getCmp("header").down("displayfield[itemId=timestamp]").setValue(Ext.Date.format(new Date(),"Y-m-d H:i:s"))}Ext.getCmp("rootViewport").suspendLayout=false;Ext.getCmp("rootViewport").doLayout();Ext.getCmp("dashboard").down("grid").setLoading(false)},cleanInputs:function(a){if(a!==null){return a.replace(/[\s.\-:]/g,"")}else{return a}},toolRefreshDashboard:function(b){var r=this;var d=com.actility.global.userId;var k="";var i=Ext.getCmp("dashboard").down("combobox[itemId=decoder]").getValue();var o=Ext.getCmp("dashboard").down("combobox[itemId=subtype]").getValue();if(o==null||o=="null"){o=""}var p=Ext.getCmp("dashboard").down("textfield[itemId=filterLRC]").getValue();var c=Ext.getCmp("dashboard").down("textfield[itemId=filterASID]").getValue();var n=Ext.getCmp("dashboard").down("datefield[itemId=fromDate]").getValue();var q=Ext.getCmp("dashboard").down("datefield[itemId=toDate]").getValue();if(n!==null){n=n.toISOString()}else{n=""}if(q!==null){q=q.toISOString()}else{q=""}if(com.actility.global.viewportType=="LORA"){var s=r.cleanInputs(Ext.getCmp("dashboard").down("textfield[itemId=filterDevAddr]").getValue());var f=r.cleanInputs(Ext.getCmp("dashboard").down("textfield[itemId=filterDevEUI]").getValue());var m=r.cleanInputs(Ext.getCmp("dashboard").down("textfield[itemId=filterLRR]").getValue());var h=Ext.getCmp("dashboard").down("textfield[itemId=filterSubscriberID]").getValue()}else{var s=Ext.getCmp("dashboard").down("textfield[itemId=filterIPV4]").getValue();var f=Ext.getCmp("dashboard").down("textfield[itemId=filterIMEI]").getValue();var m=Ext.getCmp("dashboard").down("textfield[itemId=filterMTC]").getValue();var h=""}Ext.getCmp("dashboard").down("fieldset[itemId=resultList]").setTitle(" "+com.actility.locale.translate("LBL last packets"));var l=Ext.getStore("dataStore");l.loadData([],false);var e=0;if(com.actility.global.viewportType=="LTE"){e=1}if(i==com.actility.global.AUTO_DECODER&&com.actility.global.pageSize>com.actility.global.maxAutomaticDecodedPackets){this.showDecodingWarningMessage("LBL Automatic decoding cannot be performed when more than 500 packets are displayed")}var g=com.actility.global.buildUrl("/rest/users/"+d+"/data?type="+e+"&last="+k+"&decoder="+i+"&devicesAddr="+s+"&devicesID="+f+"&LRRID="+m+"&LRCID="+p+"&fromDate="+n+"&toDate="+q+"&pageIndex="+b+"&f=utc&sessionToken="+com.actility.global.sessionToken+"&subscriberID="+h+"&ASID="+c+"&subtype="+o);var a=Ext.getCmp("rootViewport").down("gridpanel[itemId=dashboardResultGridPannel]");var j=a.getView();j.on("refresh",function(t,v,u){var w=Ext.getCmp("dashboard").down("checkboxfield[itemId=expand]").getValue();if(w===true){r.toolManageExpand(w)}});Ext.getCmp("dashboard").down("grid").setLoading(true);com.actility.ajax.ajaxCall({method:"GET",url:g,callbackSuccess:function(u){if((u!==null)&&(u.data!=undefined)){for(var t=0;t<u.data.length;t++){u.data[t]["timestampLocal"]=r.toolUTCtoLocal(u.data[t]["timestampUTC"])}l.currentPage=b;l.more=u.more;l.loadData(u.data)}else{Ext.getCmp("dashboard").down("grid").setLoading(false)}},callbackError:function(u,t){l.more=false;l.currentPage=1;l.loadData([],false);r.specificError(Ext.getCmp("footer"),u);Ext.getCmp("dashboard").down("grid").setLoading(false)}})},toolManageDisconnection:function(){var b=this;if(typeof(Ext.getCmp("message"))=="undefined"){var a=Ext.create("WirelessLogger.view.messagePanel",{id:"message",modal:true,floating:true,centered:true,listeners:{close:function(){b.toolStopDashboardRefresh();if(Ext.getCmp("rootViewport")!=undefined){Ext.getCmp("rootViewport").destroy()}Ext.WindowMgr.each(function(c){var d=c.title;if(d!=undefined){if((d.substr(0,3)=="Map")||(d.substr(0,4)=="Path")){c.destroy()}}});com.actility.specific.utils.stopTrackingUnload();if(com.actility.global.guiMode=="standalone"||com.actility.global.guiMode=="portal"){com.actility.login.displaySSOLoginPopup(com.actility.global.thingparkApplicationID,location.hostname)}}}});a.down("label[itemId=labelMessage]").setText(com.actility.locale.translate("MSG Sorry, connexion refused or timeout (invalid credential)"));a.show("pop",true)}},manageBootAfterRender:function(){},infoTextClick:function(){Ext.getCmp("login").setHeight(410);Ext.getCmp("loginSubForm").setHeight(230);Ext.getCmp("login").down("fieldset[itemId=loginForm]").setVisible(true)},updateAutologinURL:function(){var a=location.href;a+="?login="+Ext.getCmp("management").down("fieldset[itemId=edit]").down("textfield[itemId=email]").getValue();a+="&pwd="+Ext.getCmp("management").down("fieldset[itemId=edit]").down("textfield[itemId=passwordMd5]").getValue();Ext.getCmp("management").down("fieldset[itemId=edit]").down("displayfield[itemId=autologinURL]").setValue(a)},managementManageEmailChange:function(c,a,b){this.updateAutologinURL()},managementManagePasswordChange:function(c,a,b){this.updateAutologinURL()},managementManageEditClose:function(){Ext.getCmp("management").down("fieldset[itemId=edit]").setVisible(false)},managementManageCreateClose:function(){Ext.getCmp("management").down("fieldset[itemId=create]").setVisible(false)},managementManageEditSave:function(){var d=this;this.managementManageSearch();var c=Ext.getCmp("rootViewport").down("fieldset[itemId=edit]").down("form[itemId=form]").getForm();var a=c.getRecord();a.set(c.getValues());var f=Ext.create("Ext.data.writer.Json");var e=f.getRecordData(a);var b=com.actility.global.buildUrl("/rest/users/"+com.actility.global.userId+"/admin/users/"+a.get("uid")+"?sessionToken="+com.actility.global.sessionToken);com.actility.ajax.ajaxCall({method:"PUT",url:b,params:e,callbackSuccess:function(g){d.specificInfo(Ext.getCmp("footer"),"user edit saved");d.managementManageSearch();Ext.getCmp("management").down("fieldset[itemId=edit]").setVisible(false)},callbackError:function(h,g){d.specificError(Ext.getCmp("footer"),h);Ext.getCmp("management").down("grid").setLoading(false)}})},managementManageCreateSave:function(){var c=this;c.managementManageSearch();var b=Ext.getCmp("rootViewport").down("fieldset[itemId=create]").down("form[itemId=form]").getForm();var d=b.getValues();var a=com.actility.global.buildUrl("/rest/users/"+com.actility.global.userId+"/admin/users?sessionToken="+com.actility.global.sessionToken);com.actility.ajax.ajaxCall({method:"POST",url:a,params:d,callbackSuccess:function(e){c.specificInfo(Ext.getCmp("footer"),"user creation done");c.managementManageSearch();Ext.getCmp("management").down("fieldset[itemId=create]").setVisible(false)},callbackError:function(f,e){c.specificError(Ext.getCmp("footer"),f)}})},managementManageDeleteConfirm:function(b){var e=this;if(b=="yes"){var d=Ext.getCmp("management").down("grid").selModel.selected.items;if(d.length>0){var c=d[0];var a=com.actility.global.buildUrl("/rest/users/"+com.actility.global.userId+"/admin/users/"+c.get("uid")+"?sessionToken="+com.actility.global.sessionToken);com.actility.ajax.ajaxCall({method:"DELETE",url:a,callbackSuccess:function(f){e.specificInfo(Ext.getCmp("footer"),"user deletion done");e.managementManageSearch()},callbackError:function(g,f){e.specificError(Ext.getCmp("footer"),g)}})}else{e.specificWarning(Ext.getCmp("footer"),"Please select an item from the list")}}},managementManageDelete:function(){var b=Ext.getCmp("management").down("grid").selModel.selected.items;if(b.length>0){Ext.getCmp("management").down("fieldset[itemId=edit]").setVisible(false);Ext.getCmp("management").down("fieldset[itemId=create]").setVisible(false);var a=b[0];Ext.MessageBox.confirm("Confirm","Ok to delete "+a.get("username")+" ?",com.actility.specific.extjs.managementManageDeleteConfirm)}else{this.specificWarning(Ext.getCmp("footer"),"Please select an item from the list")}},managementManageEdit:function(){var c=Ext.getCmp("management").down("grid").selModel.selected.items;if(c.length>0){Ext.getCmp("management").down("fieldset[itemId=edit]").setVisible(true);Ext.getCmp("management").down("fieldset[itemId=create]").setVisible(false);var b=c[0];Ext.getCmp("rootViewport").down("form[itemId=form]").getForm().loadRecord(b);var a=location.href;a+="?login="+b.get("username");a+="&pwd="+b.get("password");Ext.getCmp("management").down("fieldset[itemId=edit]").down("displayfield[itemId=autologinURL]").setValue(a)}else{this.specificWarning(Ext.getCmp("footer"),"Please select an item from the list")}},managementManageAdd:function(){Ext.getCmp("management").down("fieldset[itemId=edit]").setVisible(false);Ext.getCmp("management").down("fieldset[itemId=create]").setVisible(true)},managementManageSearch:function(){var d=this;var b=Ext.getCmp("management").down("fieldset[itemId=search]").down("textfield[itemId=email]").getValue();var e=Ext.getCmp("management").down("fieldset[itemId=search]").down("textfield[itemId=customerId]").getValue();var c=Ext.getStore("userStore");var a=com.actility.global.buildUrl("/rest/users/"+com.actility.global.userId+"/admin/users?email="+b+"&customerId="+e+"&sessionToken="+com.actility.global.sessionToken);c.on("datachanged",function(g,f,h){d.specificInfo(Ext.getCmp("footer"),"User list loaded");Ext.getCmp("management").down("grid").setLoading(false)});Ext.getCmp("management").down("grid").setLoading(true);com.actility.ajax.ajaxCall({method:"GET",url:a,callbackSuccess:function(f){if(typeof(f.data)!="undefined"){c.loadData(f.data);if(typeof(f.message)!="undefined"){d.specificInfo(Ext.getCmp("footer"),"User list loaded "+f.message)}}else{c.loadData([])}},callbackError:function(g,f){d.specificError(Ext.getCmp("footer"),g);Ext.getCmp("management").down("grid").setLoading(false)}})},manageLoginAfterRender:function(){},manageLoginPasswordSpecialKeys:function(d,c){if(c.getKey()===c.ENTER){var a=Ext.getCmp("login").down("textfield[itemId=email]").getValue();var b=Ext.getCmp("login").down("textfield[itemId=password]").getValue();this.manageLogin(a,b)}},manageLoginButtonClick:function(){var a=Ext.getCmp("login").down("textfield[itemId=email]").getValue();var b=Ext.getCmp("login").down("textfield[itemId=password]").getValue();this.manageLogin(a,b)},manageAuthenticate:function(c,b,a,d){var e=this;var f=function(g){if(g=="unknown"){return""}return(g)?(new Date(g)).toLocaleString():""};console.warn("Thingpark WLogger manageAuthenticate type="+d);console.warn("Thingpark WLogger manageAuthenticate com.actility.global.guiMode="+com.actility.global.guiMode);com.actility.ajax.ajaxCall({method:"POST",url:com.actility.global.buildUrl("/rest/users/"+c+"/authenticate?sessionToken="+a+"&type="+d),params:{userAccount:b},callbackSuccess:function(h){com.actility.global.sessionToken=a;com.actility.global.userId=h.data.ID;com.actility.global.customerIdList=h.data.customerIds;if(h.data.disclaimer!==null&&h.data.disclaimer.disclaimerRequired&&d!="module"&&d!="portal"){var g={disclaimerMessage:h.data.disclaimer.disclaimerMessage,who:h.data.disclaimer.who,previousConnection:f(h.data.disclaimer.previousConnection),thingparkLastUnsuccessfulLogin:f(h.data.disclaimer.thingparkLastUnsuccessfulLogin),thingparkPreviousBadConsecutivePwd:h.data.disclaimer.thingparkPreviousBadConsecutivePwd,onButtonPress:e.toolStartGUI};com.actility.specific.utils.buildDisclaimer(g)}else{e.toolStartGUI()}},callbackError:function(h,g){e.specificNotification(h,"error",false)}})},manageAuthenticateByKeycloak:function(a){var b=this;var c=function(e){if(e=="unknown"){return""}return(e)?(new Date(e)).toLocaleString():""};console.warn("Thingpark WLogger manageAuthenticateByKeycloak type="+a);console.warn("Thingpark WLogger manageAuthenticateByKeycloak com.actility.global.guiMode="+com.actility.global.guiMode);com.actility.ajax.ajaxCall({method:"GET",url:com.actility.global.buildUrl("/rest/users"),callbackSuccess:function(e){com.actility.global.sessionToken=e.data.sessionId;com.actility.global.userId=e.data.ID;com.actility.global.customerIdList=e.data.customerIds;if(e.data.disclaimer!==null&&e.data.disclaimer.disclaimerRequired&&a!="module"&&a!="portal"){var d={disclaimerMessage:e.data.disclaimer.disclaimerMessage,who:e.data.disclaimer.who,previousConnection:c(e.data.disclaimer.previousConnection),thingparkLastUnsuccessfulLogin:c(e.data.disclaimer.thingparkLastUnsuccessfulLogin),thingparkPreviousBadConsecutivePwd:e.data.disclaimer.thingparkPreviousBadConsecutivePwd,onButtonPress:b.toolStartGUI};com.actility.specific.utils.buildDisclaimer(d)}else{b.toolStartGUI()}},callbackError:function(e,d){b.specificNotification(e,"error",true)}})},toolStartGUI:function(){if(Ext.getCmp("boot")){Ext.getCmp("boot").destroy()}if(Ext.getCmp("login")){Ext.getCmp("login").destroy()}if(com.actility.global.viewport!=null){com.actility.global.viewport.destroy()}com.actility.specific.extjs.refreshCustomerList();if(com.actility.global.viewportType=="LTE"){com.actility.global.viewport=Ext.create("WirelessLogger.view.viewportLte")}else{com.actility.global.viewport=Ext.create("WirelessLogger.view.viewportLora")}com.actility.global.viewport.show();if(com.actility.global.lteModeActif===true){Ext.getCmp("protocolSwitch").setVisible(true)}if(com.actility.global.guiMode==="module"){Ext.getCmp("north").destroy();Ext.getCmp("rootViewport").down("button[itemId=logout]").setVisible(false)}else{com.actility.specific.utils.startTrackingUnload()}com.actility.specific.extjs.toolRefreshCustomerList()},manageLogin:function(a,b){var c=this;if(a==""||b==""){this.specificNotification(com.actility.locale.translate("WR Please enter an Email and Password"),"error",false)}else{com.actility.ajax.ajaxCall({method:"POST",url:com.actility.global.buildUrl("/rest/users/logingui"),params:{username:a,password:b},callbackSuccess:function(d){com.actility.global.sessionToken=d.data.sessionId;com.actility.global.userId=d.data.ID;com.actility.global.customerIdList=d.data.customerIds;c.toolStartGUI("unknown");c.toolRefreshCustomerList()},callbackError:function(e,d){c.specificNotification(e,"error",false)}})}},manageTreeViewClick:function(a,c){var b=Ext.getCmp("navigationTreePanel").getStore().getNodeById(a.get("id"));if(b==undefined){return}Ext.getCmp("navigationTreePanel").getSelectionModel().select(a);if(b.data.text=="Dashboard"){Ext.getCmp("rootViewport").down("container[itemId=container]").getLayout().setActiveItem(0)}else{if(b.data.text=="Management"){Ext.getCmp("rootViewport").down("container[itemId=container]").getLayout().setActiveItem(1)}}},manageToolCombo:function(a){if(a=="LPWA-LoRa"){com.actility.specific.extjs.manageGearMenuLora(1,true)}if(a=="Cellular"){com.actility.specific.extjs.manageGearMenuLTE(1,true)}},manageToolGear:function(f,c,a,b){var d=this;var h=Ext.getCmp("protocolMenu");if(!h){var g=true;if(com.actility.global.viewportType!=="LORA"){g=false}h=Ext.create("Ext.menu.Menu",{id:"protocolMenu",items:['<b class="menu-title">'+com.actility.locale.translate("LBL Choose a Protocol")+"</b>",{text:com.actility.locale.translate("LBL LPWA - LoRa"),group:"protocol",checked:g,checkHandler:d.manageGearMenuLora},{text:com.actility.locale.translate("LBL Cellular"),group:"protocol",checked:!g,checkHandler:d.manageGearMenuLTE}]})}h.showBy(a,"tr-br?")},manageGearMenuLora:function(c,b){var a="unchecked";if(b){a="checked";com.actility.global.viewportType="LORA";com.actility.specific.extjs.toolStartGUI()}},manageGearMenuLTE:function(c,b){var a="unchecked";if(b){a="checked";com.actility.global.viewportType="LTE";com.actility.specific.extjs.toolStartGUI()}},manageResize:function(b,a){},manageDashboardLogoutClick:function(){if(!Ext.isEmpty(WirelessLogger)&&!Ext.isEmpty(WirelessLogger.util)&&!Ext.isEmpty(WirelessLogger.util.Keycloak)&&WirelessLogger.util.Keycloak.isReady()){WirelessLogger.util.Keycloak.logout()}com.actility.specific.utils.logout(function(){},function(){})},manageDashboardMapPathClick:function(a){com.actility.specific.utils.mapExecuteOrLoadMapAPI(this.executeDashboardMapPathClick,a)},executeDashboardMapPathClick:function(c){var d=c.get("LrrLAT");var a=c.get("LrrLON");var m=c.get("DevEUI");var j=Ext.getStore("dataStore");var f=j.getAt(0).get("uid");var q=j.getAt(0).get("uid");j.each(function(s){if(s.get("uid")>f){f=s.get("uid")}if(s.get("uid")<q){q=s.get("uid")}});var k=Ext.getCmp("dashboard").down("combobox[itemId=decoder]").getValue();var o=Ext.getCmp("dashboard").down("combobox[itemId=subtype]").getValue();if(o==null||o=="null"){o=""}var p=Ext.getCmp("dashboard").down("textfield[itemId=filterLRC]").getValue();var b=Ext.getCmp("dashboard").down("textfield[itemId=filterASID]").getValue();if(com.actility.global.viewportType=="LORA"){var r=com.actility.specific.extjs.cleanInputs(Ext.getCmp("dashboard").down("textfield[itemId=filterDevAddr]").getValue());var g=com.actility.specific.extjs.cleanInputs(Ext.getCmp("dashboard").down("textfield[itemId=filterDevEUI]").getValue());var n=com.actility.specific.extjs.cleanInputs(Ext.getCmp("dashboard").down("textfield[itemId=filterLRR]").getValue());var i=Ext.getCmp("dashboard").down("textfield[itemId=filterSubscriberID]").getValue()}else{var r=Ext.getCmp("dashboard").down("textfield[itemId=filterIPV4]").getValue();var g=Ext.getCmp("dashboard").down("textfield[itemId=filterIMEI]").getValue();var n=Ext.getCmp("dashboard").down("textfield[itemId=filterMTC]").getValue();var i=""}var l="";var e=0;if(com.actility.global.viewportType=="LTE"){e=1}var h=com.actility.global.buildUrl("/rest/users/"+com.actility.global.userId+"/devices/"+m+"/locations?last="+l+"&type="+e+"&startUid="+q+"&endUid="+f+"&decoder="+k+"&devicesAddr="+r+"&devicesID="+g+"&LRRID="+n+"&LRCID="+p+"&sessionToken="+com.actility.global.sessionToken+"&subscriberID="+i+"&ASID="+b+"&subtype="+o);com.actility.ajax.ajaxCall({method:"GET",url:h,callbackSuccess:function(u){com.actility.specific.extjs.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR Device path retrieved"));var t=null;var v=c.get("distance");if((v!==0)&&(v!==null)&&(v!="null")&&(v!="")){t=Number(v)}var s={cartoType:"path",title:"Path ["+m+"]",deviceUid:m,distance:t,lrrLat:c.get("LrrLAT"),lrrLon:c.get("LrrLON"),lrrId:c.get("Lrrid"),data:u.data,onMapReady:com.actility.specific.utils.mapCallbackDisplayPath};com.actility.specific.utils.buildMapPanel(s)},callbackError:function(t,s){com.actility.specific.extjs.specificError(Ext.getCmp("footer"),com.actility.locale.translate("WR Device path cannot be retrieved"))}})},manageDashboardMapLocationClick:function(a){com.actility.specific.utils.mapExecuteOrLoadMapAPI(this.executeDashboardMapLocationClick,a)},executeDashboardMapLocationClick:function(a){var e=a.get("LrrLAT");var g=a.get("LrrLON");var d=a.get("DevEUI");var c=null;var f=a.get("distance");if((f!==0)&&(f!==null)&&(f!="null")&&(f!="")){c=Number(f)}var b={cartoType:"loc",title:"Map ["+d+"]",distance:c,timestampUTC:a.get("timestampUTC"),lrrLat:a.get("LrrLAT"),lrrLon:a.get("LrrLON"),lrrId:a.get("Lrrid"),devLat:a.get("DevLAT"),devLon:a.get("DevLON"),deviceUid:a.get("DevEUI"),sf:a.get("SpFact"),snr:a.get("LrrSNR"),rssi:a.get("LrrRSSI"),esp:a.get("LrrESP"),mtc:a.get("Lrrid"),imei:a.get("DevEUI"),msiisdn:a.get("lteMSISDN"),onMapReady:com.actility.specific.utils.mapCallbackDisplayLocalization};com.actility.specific.utils.buildMapPanel(b)},manageDashboardMapClick:function(){com.actility.specific.utils.mapExecuteOrLoadMapAPI(this.executeDashboardMapClick)},executeDashboardMapClick:function(){var i=com.actility.global.userId;var m="";var e=Ext.getCmp("dashboard").down("combobox[itemId=decoder]").getValue();var j=Ext.getCmp("dashboard").down("combobox[itemId=subtype]").getValue();if(j==null||j=="null"){j=""}if(com.actility.global.viewportType=="LORA"){var b=com.actility.specific.extjs.cleanInputs(Ext.getCmp("dashboard").down("textfield[itemId=filterDevAddr]").getValue());var c=com.actility.specific.extjs.cleanInputs(Ext.getCmp("dashboard").down("textfield[itemId=filterDevEUI]").getValue());var f=com.actility.specific.extjs.cleanInputs(Ext.getCmp("dashboard").down("textfield[itemId=filterLRR]").getValue());var g=Ext.getCmp("dashboard").down("textfield[itemId=filterSubscriberID]").getValue()}else{var b=Ext.getCmp("dashboard").down("textfield[itemId=filterIPV4]").getValue();var c=Ext.getCmp("dashboard").down("textfield[itemId=filterIMEI]").getValue();var f=Ext.getCmp("dashboard").down("textfield[itemId=filterMTC]").getValue();var g=""}var n=Ext.getCmp("dashboard").down("textfield[itemId=filterLRC]").getValue();var d=Ext.getCmp("dashboard").down("textfield[itemId=filterASID]").getValue();var l=Ext.getCmp("dashboard").down("datefield[itemId=fromDate]").getValue();var h=Ext.getCmp("dashboard").down("datefield[itemId=toDate]").getValue();if(l!==null){l=l.toISOString()}else{l=""}if(h!==null){h=h.toISOString()}else{h=""}var k=0;if(com.actility.global.viewportType=="LTE"){k=1}var a=com.actility.global.buildUrl("/rest/users/"+i+"/data?type="+k+"&last="+m+"&decoder="+e+"&devicesAddr="+b+"&devicesID="+c+"&LRRID="+f+"&LRCID="+n+"&fromDate="+l+"&toDate="+h+"&f=utc&sessionToken="+com.actility.global.sessionToken+"&subscriberID="+g+"&ASID="+d+"&subtype="+j);com.actility.ajax.ajaxCall({method:"GET",url:a,callbackSuccess:function(p){com.actility.specific.extjs.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR Map retrieved"));var o={cartoType:"history",title:"Map",data:p.data,onMapReady:com.actility.specific.utils.mapCallbackDisplayLastPositions};com.actility.specific.utils.buildMapPanel(o)},callbackError:function(p,o){com.actility.specific.extjs.specificError(Ext.getCmp("footer"),com.actility.locale.translate("WR Map cannot be retrieved"))}})},manageDashboardExportClick:function(){var q=this;var g=Ext.getStore("dataStore");if(g.getCount()===0){this.specificWarning(Ext.getCmp("footer"),com.actility.locale.translate("WR Nothing to export"));return}var c=g.getAt(0).get("uid");var p=g.getAt(0).get("uid");g.each(function(s){if(s.get("uid")>c){c=s.get("uid")}if(s.get("uid")<p){p=s.get("uid")}});var h=Ext.getCmp("dashboard").down("combobox[itemId=decoder]").getValue();var m=Ext.getCmp("dashboard").down("combobox[itemId=subtype]").getValue();if(m==null||m=="null"){m=""}if(com.actility.global.viewportType=="LORA"){var r=q.cleanInputs(Ext.getCmp("dashboard").down("textfield[itemId=filterDevAddr]").getValue());var d=q.cleanInputs(Ext.getCmp("dashboard").down("textfield[itemId=filterDevEUI]").getValue());var k=q.cleanInputs(Ext.getCmp("dashboard").down("textfield[itemId=filterLRR]").getValue());var f=Ext.getCmp("dashboard").down("textfield[itemId=filterSubscriberID]").getValue()}else{var r=Ext.getCmp("dashboard").down("textfield[itemId=filterIPV4]").getValue();var d=Ext.getCmp("dashboard").down("textfield[itemId=filterIMEI]").getValue();var k=Ext.getCmp("dashboard").down("textfield[itemId=filterMTC]").getValue();var f=""}var n=Ext.getCmp("dashboard").down("textfield[itemId=filterLRC]").getValue();var a=Ext.getCmp("dashboard").down("textfield[itemId=filterASID]").getValue();var i=Ext.getCmp("dashboard").down("textfield[itemId=last]").getValue();var l=Ext.getCmp("dashboard").down("datefield[itemId=fromDate]").getValue();var o=Ext.getCmp("dashboard").down("datefield[itemId=toDate]").getValue();if(l!==null){l=l.toISOString()}else{l=""}if(o!==null){o=o.toISOString()}else{o=""}var b=0;if(com.actility.global.viewportType=="LTE"){b=1}var j=parseInt(i);if(h==com.actility.global.AUTO_DECODER&&j>com.actility.global.maxAutomaticDecodedPackets){this.showDecodingWarningMessage("LBL Automatic decoding cannot be performed when more than 500 packets are exported")}var e=com.actility.global.buildUrl("/rest/users/"+com.actility.global.userId+"/export?type="+b+"&last="+i+"&startUid="+p+"&endUid="+c+"&decoder="+h+"&devicesAddr="+r+"&devicesID="+d+"&LRRID="+k+"&LRCID="+n+"&fromDate="+l+"&toDate="+o+"&f=utc&sessionToken="+com.actility.global.sessionToken+"&subscriberID="+f+"&ASID="+a+"&subtype="+m);window.open(e,"download");this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR Export done"))},showDecodingWarningMessage:function(b){var a=com.actility.locale.translate(b);a=a.replace("%s",com.actility.global.maxAutomaticDecodedPackets);Ext.Msg.alert("Warning",a);com.actility.specific.extjs.specificWarning(Ext.getCmp("footer"),a)},manageDashboardDevAddrClearClick:function(){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR DevAddr filtering deactivated"));Ext.getCmp("dashboard").down("textfield[itemId=filterDevAddr]").setValue("")},manageDashboardDevEUIClearClick:function(){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR DevEUI filtering deactivated"));Ext.getCmp("dashboard").down("textfield[itemId=filterDevEUI]").setValue("")},manageDashboardLRRClearClick:function(){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR LRR filtering deactivated"));Ext.getCmp("dashboard").down("textfield[itemId=filterLRR]").setValue("")},manageDashboardLRCClearClick:function(){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR LRC filtering deactivated"));Ext.getCmp("dashboard").down("textfield[itemId=filterLRC]").setValue("")},manageDashboardASIDClearClick:function(){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR ASID filtering deactivated"));Ext.getCmp("dashboard").down("textfield[itemId=filterASID]").setValue("")},manageDashboardSubIDClearClick:function(){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR SubscriberID filtering deactivated"));Ext.getCmp("dashboard").down("textfield[itemId=filterSubscriberID]").setValue("")},manageDashboardSubTypeClearClick:function(){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR Packet type filtering deactivated"));Ext.getCmp("dashboard").down("combobox[itemId=subtype]").setValue("")},manageDashboardDeviceAddrFiltering:function(a){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR Filtering on DevAddr")+" "+a+" "+com.actility.locale.translate("WR selected"));Ext.getCmp("dashboard").down("textfield[itemId=filterDevAddr]").setValue(a)},manageDashboardSubscriberFiltering:function(a){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR Filtering on Subscriber")+" "+a+" "+com.actility.locale.translate("WR selected"));Ext.getCmp("dashboard").down("textfield[itemId=filterSubscriberID]").setValue(a)},manageDashboardSensorIPV4Filtering:function(a){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR Filtering on Sensor IPV4")+" "+a+" "+com.actility.locale.translate("WR selected"));Ext.getCmp("dashboard").down("textfield[itemId=filterIPV4]").setValue(a)},manageDashboardSensorIPV4ClearClick:function(){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR IPV4 filtering deactivated"));Ext.getCmp("dashboard").down("textfield[itemId=filterIPV4]").setValue("")},manageDashboardIMEIFiltering:function(a){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR Filtering on IMEI")+" "+a+" "+com.actility.locale.translate("WR selected"));Ext.getCmp("dashboard").down("textfield[itemId=filterIMEI]").setValue(a)},manageDashboardIMEIClearClick:function(){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR IMEI filtering deactivated"));Ext.getCmp("dashboard").down("textfield[itemId=filterIMEI]").setValue("")},manageDashboardMTCFiltering:function(a){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR Filtering on MTC")+" "+a+" "+com.actility.locale.translate("WR selected"));Ext.getCmp("dashboard").down("textfield[itemId=filterMTC]").setValue(a)},manageDashboardMTCClearClick:function(){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR MTC filtering deactivated"));Ext.getCmp("dashboard").down("textfield[itemId=filterMTC]").setValue("")},manageDashboardDeviceUIDFiltering:function(a){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR Filtering on DevEUI")+" "+a+" "+com.actility.locale.translate("WR selected"));Ext.getCmp("dashboard").down("textfield[itemId=filterDevEUI]").setValue(a)},manageDashboardLRRIdFiltering:function(a){this.specificInfo(Ext.getCmp("footer"),com.actility.locale.translate("WR Filtering on LRR")+" "+a+" "+com.actility.locale.translate("WR selected"));Ext.getCmp("dashboard").down("textfield[itemId=filterLRR]").setValue(a)},manageDashboardLRCIdFiltering:function(a){this.specificWarning(Ext.getCmp("footer"),com.actility.locale.translate("WR Filtering on LRC")+" "+a+" "+com.actility.locale.translate("WR selected"));Ext.getCmp("dashboard").down("textfield[itemId=filterLRC]").setValue(a)},manageDashboardRefreshClick:function(){this.toolRefreshDashboard(1)},manageDashboardAfterRender:function(){this.toolRefreshCustomerList();this.toolRefreshDashboard(1);var a=Ext.getStore("dataStore");a.addListener("datachanged",com.actility.specific.extjs.callbackStoreDataChanged)},manageDashboardAutoReloadChange:function(a){if(a===0){this.toolStopDashboardRefresh()}else{this.toolStartDashboardRefresh(a)}},manageDashboardExpandAllChange:function(a){this.toolManageExpand(a)},bottomToolbarInfoTextChange:function(d,a){function b(g,e,f){filteringBegin=g.indexOf(e);if(filteringBegin<=0){return}filteringBegin+=e.length;filteringPart=g.substring(filteringBegin);filteringEnd=filteringPart.indexOf("\n");filtering=filteringPart.substring(0,filteringEnd);f.setValue(filtering)}var c=this;if(com.actility.global.viewportType=="LORA"){b(a,"DevAddr(s) : ",Ext.getCmp("dashboard").down("textfield[itemId=filterDevAddr]"));b(a,"DevEUI(s)  : ",Ext.getCmp("dashboard").down("textfield[itemId=filterDevEUI]"));b(a,"LRR Ids    : ",Ext.getCmp("dashboard").down("textfield[itemId=filterLRR]"));b(a,"Sub Id     : ",Ext.getCmp("dashboard").down("textfield[itemId=filterSubscriberID]"))}else{b(a,"DevAddr(s) : ",Ext.getCmp("dashboard").down("textfield[itemId=filterIPV4]"));b(a,"DevEUI(s)  : ",Ext.getCmp("dashboard").down("textfield[itemId=filterIMEI]"));b(a,"LRR Ids    : ",Ext.getCmp("dashboard").down("textfield[itemId=filterMTC]"))}b(a,"LRC Ids    : ",Ext.getCmp("dashboard").down("textfield[itemId=filterLRC]"));b(a,"From       : ",Ext.getCmp("dashboard").down("datefield[itemId=fromDate]"));b(a,"To         : ",Ext.getCmp("dashboard").down("datefield[itemId=toDate]"));b(a,"Decoder    : ",Ext.getCmp("dashboard").down("combobox[itemId=decoder]"));b(a,"subtype    : ",Ext.getCmp("dashboard").down("combobox[itemId=subtype]"));b(a,"Last       : ",Ext.getCmp("dashboard").down("combobox[itemId=last]"))},bottomToolbarInfoClick:function(){var i=this;var l=Ext.getCmp("dashboard").down("combobox[itemId=last]").getValue();var d=Ext.getCmp("dashboard").down("combobox[itemId=decoder]").getValue();var h=Ext.getCmp("dashboard").down("combobox[itemId=subtype]").getValue();if(h==null||h=="null"){h=""}if(com.actility.global.viewportType=="LORA"){var a=i.cleanInputs(Ext.getCmp("dashboard").down("textfield[itemId=filterDevAddr]").getValue());var b=i.cleanInputs(Ext.getCmp("dashboard").down("textfield[itemId=filterDevEUI]").getValue());var e=i.cleanInputs(Ext.getCmp("dashboard").down("textfield[itemId=filterLRR]").getValue());var f=Ext.getCmp("dashboard").down("textfield[itemId=filterSubscriberID]").getValue()}else{var a=Ext.getCmp("dashboard").down("textfield[itemId=filterIPV4]").getValue();var b=Ext.getCmp("dashboard").down("textfield[itemId=filterIMEI]").getValue();var e=Ext.getCmp("dashboard").down("textfield[itemId=filterMTC]").getValue();var f=""}var n=Ext.getCmp("dashboard").down("textfield[itemId=filterLRC]").getValue();var c=Ext.getCmp("dashboard").down("textfield[itemId=filterASID]").getValue();var k=Ext.Date.format(Ext.getCmp("dashboard").down("datefield[itemId=fromDate]").getValue(),"Y-m-d");var j=Ext.Date.format(Ext.getCmp("dashboard").down("datefield[itemId=toDate]").getValue(),"Y-m-d");var m="Current settings\n";m+="----------------\n";m+="Filtering\n";m+="DevAddr(s) : "+a+"\n";m+="DevEUI(s)  : "+b+"\n";m+="LRR Ids    : "+e+"\n";m+="LRC Ids    : "+n+"\n";m+="Sub Id     : "+f+"\n";m+="From       : "+k+"\n";m+="To         : "+j+"\n";m+="-----------------\n";m+="Decoder    : "+d+"\n";m+="subtype    : "+h+"\n";m+="Last       : "+l+"\n";var g=Ext.create("Ext.window.Window",{title:"Settings",height:280,width:400,layout:"fit",items:[{xtype:"textareafield",anchor:"100%",value:m,fieldStyle:{fontFamily:"courier new",fontSize:"12px"},listeners:{change:i.bottomToolbarInfoTextChange}}],closable:true,resizable:true});g.show()}}});